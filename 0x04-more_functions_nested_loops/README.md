more funtions and nested loop
